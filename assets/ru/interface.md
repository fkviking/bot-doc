---
title: 3. Интерфейс сайта
section: 3
---

# Интерфейс сайта

## Система виджетов

Основная страница интерфейса представлена набором виджетов. Большинство виджетов имеют в своей основе таблицы, есть еще виджеты, в основе которых лежат графики. Виджеты на основе таблиц можно открыть с помощью выпадающего списка `Widgets`. Виджеты на основе графиков могут быть открыты только с помощью специальной кнопки в другом виджете. Все виджеты на основе таблиц могут быть открыты и закрыты в любом количестве и порядке, кроме виджета `Robot logs`, который открыт всегда в единственном экземпляре. Виджетов-графиков может быть открыто одновременно не более 10. Сайт существует в десктопном и мобильном (адаптированном для смартфонов) вариантах. Все положения данной главы применимы к обоим вариантам, если не указано иное. В десктопном варианте можно перемещать виджеты внутри окна браузера и изменять их размеры, в мобильном варианте единовременно открыт только один виджет, занимая при этом всё окно браузера, остальные виджеты существуют в виде вкладок, между которыми возможно переключение.

|![Alt text](@images/widgets_list.png)|
|:--:|
| *Рис. 1* |

Стоит заметить, что все виджеты настраиваемые. Можно менять местами столбцы, регулировать их ширину, а так же скрывать ненужные столбцы через закладку `Columns`. Возможно одновременное открытие нескольких одинаковых виджетов с использованием в них разных настроек. Настроенное рабочее пространство можно сохранить в `Workspaces` и позже загружать его на другие устройства. Также есть возможность экспорта и импорта `Workspaces` через файл. Это позволяет пользователям с несколькими ролями перенести настроенные `Workspaces` из одной роли в другую.

### Элементы управления виджетов на основе таблиц

Все виджеты, в основе которых лежат таблицы, имеют общие черты. Так, внешний вид элементов управления един для всех виджетов. Рассмотрим его на примере виджета `Portfolios table`.

|![Alt text](@images/widget_header.png)|
|:--:|
| *Рис. 2* |

Разберём подробно элементы интерфейса виджета, отмеченные на рисунке 2 числами. В разных виджетах те или иные элементы интерфейса могут отсутствовать по причине не применимости данного элемента к содержимому конкретного виджета. Кроме того, в верхней строке виджета могут присутствовать дополнительные элементы управления, характерные только для конкретного виджета, такие элементы управления будут описаны в каждом виджете отдельно.

1. Заголовок виджета. Кроме имени виджета может содержать дополнительную информацию, такую как номер робота для виджетов, содержащих данные по конкретному роботу. В десктопном варианте сайта возможно перемещение виджета внутри страницы сайта мышкой за заголовок.
2. Фильтр, применяется только в виджете `Portfolios table`, позволяет скрыть портфели, не удовлетворяющие критериям фильтра. Фильтрация портфелей осуществляется непосредственно на сервере, на сайт отправляются только портфели, удовлетворяющие условиям фильтра. Рекомендуется первичную фильтрацию выполнять именно с помощью фильтра, так как он, в отличие от строки поиска, снижает количество данных, передаваемых по сети, что положительно сказывается на отзывчивости интерфейса сайта. Фильтрация осуществляется без учёта регистра букв, т.е. строчные и заглавные буквы при фильтрации неотличимы.
3. Строка поиска, позволяет осуществлять фильтрацию данных, уже загруженных в таблицу. Поиск осуществляется без учёта регистра букв, т.е. строчные и заглавные буквы при поиске неотличимы.
4. Список действий, применяемых к выбранным элементам таблицы. Может быть отдельным пунктом, а может быть скрыт под шестеренкой из пункта 5.
5. Настройки виджета, могут так же содержать список действий над выбранными элементами таблицы.
6. Кнопки управления окном виджета: развернуть виджет на всю рабочую область и закрыть виджет.
7. Управление отображением столбцов таблицы, с помощью этого меню можно отключать отображение столбцов таблицы, значения которых Вас не интересуют.
8. "Тело" виджета, представляет из себя таблицу. Возможности таблиц будут описаны далее.
9. Элемент, упрощающий группировку строк. Для включения группировки строк таблицы по значения определенного столбца достаточно заголовок нужного столбца таблицы перетащить мышкой или пальцем на эту надпись.

### Возможности таблиц

|![Alt text](@images/table_functions.png)|
|:--:|
| *Рис. 3* |

Доступ к большинству функций таблиц осуществляется либо через элементы управления виджета, описанные выше, либо через заголовок. Клик на заголовке столбца приводит к сортировке, при наведении курсора на заголовок столбца появляется кнопка меню, меню в открытом виде выглядит как на рисунке 3. Для более наглядного отображения данных в таблицах разных виджетов может применяться выделение цветом значений в отдельных столбцах в случае выполнения какого-либо условия (например, когда осталось мало дней до окончания срока лицензии), кроме того, если для расчёта значения не хватает данных, то в ячейке таблицы будет отображен восклицательный знак рядом со значением ячейки (самый частый случай - поле портфеля не может быть посчитано, так как маркет-дата подключение не онлайн). В таблицах виджетов поддерживаются следующие функции из числа не описанных выше:

- **Сортировка** - сортировка строк таблицы в соответствии со значениями конкретного столбца.
- **Группировка** - группировка строк таблицы в соответствии со значениями конкретного столбца. Пример группировки по столбцу `Robot` показан на рисунке 4.
    
 |![Alt text](@images/table_group.png)|
 |:--:|
 | *Рис. 4* |

- **Фиксация столбца** - фиксация столбца слева или справа таблицы. Такой столбец не будет перемещаться при горизонтальной прокрутке. Чаще всего фиксируют столбцы, которые однозначно идентифицируют строку, например идентификатор робота или имя портфеля. Можно фиксировать несколько столбцов.
- **Автоматическое изменение ширины столбца** - автоматическое изменение ширины столца в соответствии с содержимым всех строк таблицы.
- **Выделение жирным** - выделение жирным всех значений выбранного столца.
- **Изменение цвета** - изменение цвета всех значений выбранного столбца.

### Возможности графиков

|![Doc](@images/3.5_2.jpg)|
|:--:|
| *Рис. 5* |

Графики реализованы на базе графиков TraidingView, поэтому для графиков доступна значительная часть инструментария TradingView: масштабирование графика, построение дополнительных линий и индикаторов, изменение цвета линий и холста и многое другое.

### Сохранение состояния виджетов

С помощью меню `Workspaces` есть возможность сохранения текущей конфигурации рабочего пространства. При этом сохраняется состояние виджетов (открыт или закрыт виджет, положение на рабочем пространстве для открытых виджетов), состояние таблиц (размеры столбцов, настройки отображения столбцов, сортировка, группировка и т.д.), состояние графиков (выбранные инструменты, индикаторы, дополнительные линии,  временная шкала для исторических графиков и т.д.). Кроме того, сохраняются фильтры, примененные к таблице портфелей. Можно сохранять до 10 рабочих пространств. В дальнейшем рабочее пространство можно загрузить, чтобы получить привычную рабочую среду на другом устройстве. Сохраненные конфигурации можно обновлять, удалять, а так же экспортировать в файл для дальнейшей импорта. Экспорт в файл и импорт из файла позволяют пользователям с несколькими ролями перенести настроенные `Workspaces` из одной роли в другую.

## Описание виджетов

На сайте используется система ролей пользователей. Для разных ролей могут быть доступны разные виджеты, наполнение виджетов от роли к роли так же может меняться, например, под одной ролью могут отсутствовать столцы таблицы, доступные под другой. Будем рассматривать виджеты и наполнение виджетов в том виде, в каком оно отображается для пользователя под ролью `Trader`. Виджеты, доступные под этой ролью, будут описаны далее.

### Robot logs <Anchor :ids="['robot_logs']" />

Виджет, отображающий важные записи в лог по всем доступным пользователю роботам. Логи в виджете копятся с момента последней загрузки страницы. В данный виджет попадают не все записи в лог, а только требующие внимания - ошибки и предупреждения. Этот виджет нельзя скрыть. Данный виджет предназначен для онлайн отображения важных сообщений, общее количество сообщений, отображаемых в данном виджете ограничено, поэтому для поиска сообщений рекомендуется пользоваться виджетом [Robot logs history](interface.md#robot_logs_history). Виджет всегда представлен в единственном экземпляре. В соотвествии с обновлением системы от 22 июня 2025 года срок хранения исторических данных составляет 6 месяцев.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время наступления события, отображается локальное время в соответствии с часовым поясом, используемым на устройстве пользователя;
- **Level** - уровень логирования;
- **Robot** - идентификатор робота;
- **Portfolio** - имя портфеля;
- **Message** - текст сообщения;

### Robots table <Anchor :ids="['robots_table']" />

Виджет, содержащий список доступных роботов и справочную информацию по ним. Например, из этого виджета можно понять сколько дней до кончания лицензии или сколько торговых подключений можно создать в конкретном роботе. В этом виджете отображается локальное время сервера, на котором находится конкретный робот. Именно на это время стоит ориентироваться при задании расписания.

В основной таблице виджета присутствуют следующие столбцы:

- **Robot ID** - идентификатор робота, его следует указывать при написании обращений в поддержку с вопросами по работе данного робота;
- **Name** - имя робота, по сути подпись для удобства восприятия, которая может быть изменена отрудниками поддержки или `Head of traders`;
- **Company** - название компании, которой принадлежит робот;
- **Days paid** - количество оставшихся оплаченных дней в соответвии с Вашей лицензией;
- **Robot time** - локальное время сервера, на котором запущен робот;
- **Connection limit** - максимальное количество торговых подключений, которые можно добавить в робота в соответствии с Вашей лицензией;
- **Process status** - статус основного процесса робота, отображающий запущен ли процесс или нет;
- **Trading status** - состояние торговли по роботу, робот считается торгующим, если торговля запущена хотя бы на одном из портфелей робота, при наведении курсора на данный статус появляется всплывающая подсказка, отображающая детальную информацию торгуется/не торгуется по каждому из портфелей робота;
- **Connect to back** - статус подключенности робота к серверу управления роботами, агрегирующему информацию со всех роботов для передачи на сайт или через API;
- **Market data** - состояние маркет-дата подключений робота, возможные статусы:
 * `Connected`  отображается только когда все маркет-дата подключения робота онлайн или отключены по времени (так сделано, чтобы сохранить зеленый цвет ячейки, так как именно статусы подключений "подключено" и "отключено по времени" являются штатным состоянием подключений), примеры двух этих ситуаций приведены на рисунках 6 и 7 соответственно;
 
  |![Doc](@images/md_connected.png)|
  |:--:|
  | *Рис. 6* |
  
  |![Doc](@images/md_closedbytime.png)|
  |:--:|
  | *Рис. 7* |
 
 * `Disconnected` отображается только когда все маркет-дата подключения отключены;
 * `Connecting` отображается когда среди маркет-дата подключений есть как отключенные, так и подключенные;
 
 при наведении курсора на данный статус появляется всплывающая подсказка, отображающая детальную информацию по состоянию маркет-дата подключений;
 
- **Trade connection** - состояние торговых подключений робота, возможные статусы:
 * `Connected`  отображается только когда все торговых подключения робота онлайн или отключены по времени;
 * `Disconnected` отображается только когда все торговых подключения отключены;
 * `Connecting` отображается когда среди торговых подключений есть как отключенные, так и подключенные;
 
 при наведении курсора на данный статус появляется всплывающая подсказка, отображающая детальную информацию по состоянию торговых подключений;
 
- **Production transactions count** - сумма количеств торговых транзакций (выставлений/снятий/переставлений заявок) по всем боевым (не `Virtual`) подключениям робота, отправленных через подключение за день, значение обнуляется ежедневно в 5:40 по времени сервера, при наведении курсора на данный статус появляется всплывающая подсказка, отображающая детальную информацию о количестве транзакций по каждому подключению;
- **Virtual transactions count** - количество торговых транзакций (выставлений/снятий/переставлений заявок) в `Virtual` подключении (т.е. без реальной отправки на какую-либо биржу), отправленных через подключение за день, значение обнуляется ежедневно в 5:40 по времени сервера;
- **Version number** - номер версии бинарного файла робота, запущенного в данный момент, в случае отличия от `Server version number` поле будет подсвечено желтым цветом;
- **Version date** - дата последних изменений в исходном коде, включенных в бинарный файл робота, запущенный в данный момент;
- **Server version number** - номер версии бинарного файла, загруженного на сервер и используемого при перезапуске робота, т.е. при перезапуске робота робот всегда обновляется на последнюю доступную версию, загруженную на сервер, в случае отличия от `Version number` поле будет подсвечено желтым цветом;
- **Server version date** - дата последних изменений в исходном коде, включенных в бинарный файл робота, загруженный на сервер и используемый при перезапуске.

### Portfolios table <Anchor :ids="['portfolios_table']" />

Виджет, содержащий таблицу портфелей. По сути основной виджет, используемый при торговле. Через этот виджет осуществляется создание новых портфелей, удаление старых и изменение параметров существующих портфелей. Кнопка `ADD` используется для создания новых [портфелей](getting-started.md#portfolio_add). В меню `ACTIONS` находятся действия, которые можно выполнять с одним или несколькими портфелями. Описание действий с портфелями находится [тут](getting-started.md#portfolio_actions). Значения столбцов таблицы совпадают с [параметрами портфеля](params-description.md#p).

### Robot logs history <Anchor :ids="['robot_logs_history']" />

Виджет, содержащий логи по заданному роботу за конкретный период времени (но не более 100 000 записей). Поддерживается фильтрация логов по ключевым словам, в качестве ключевого слова можно, например, использовать имя портфеля или торгового подключения. В данный виждет попадают все записи в лог, доступные пользователю. Поддерживается экспорт содержимого таблицы в файл. В соотвествии с обновлением системы от 22 июня 2025 года срок хранения исторических данных составляет 6 месяцев.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время наступления события, отображается локальное время в соответствии с часовым поясом, используемым на устройстве пользователя;
- **Level** - уровень логирования;
- **Robot** - идентификатор робота;
- **Portfolio** - имя портфеля;
- **Message** - текст сообщения.

### Finres for today <Anchor :ids="['finres_for_today']" />

Виджет, содержащий последние раздвижки. Есть возможность отображения всех раздвижек по роботу или только по конкретному портфелю. Так же для конкретного портфеля можно рассчитать среднюю раздвижку на заданном временном отрезке. В соотвествии с обновлением системы от 22 июня 2025 года срок хранения исторических данных составляет 6 месяцев.

Раздвижки, попадающие в данный виджет, формируются следующим образом: проходит сделка по первой ноге, после чего происходит попытка выставления заявки по инструментам второй ноги, если заявки выставлены, то раздвижка будет сформирована и добавлена в таблицу только когда все заявки по второй ноге будут сведены в сделку или их переставление закончится ошибкой, если заявки второй ноги не выставлены (была получена ошибка выставления или выставление заявок по второй ноге не требовалась в соответствии с настройками портфеля), то раздвижка будет сформирована и добавлена сразу (при получении ошибки выставления заявки по инструментам второй ноги или после сделки по первой ноге, если выставление заявки по второй ноге не требовалось), при этом так как раздвижки считаются по сделкам, а сделка прошла только по инструменту первой ноги, то раздвижка будет "одноногой". По описанной выше причине количество "одноногих" раздвижек может вырасти при задании ненулевого значения параметра [Overlay](params-description.md#p.overlay). Сделки по выравнивающим заявкам, выставляемым по инструментам второй ноги, раздвижку не формируют и в этот виджет не попадают.

Средняя раздвижка считается непосредственно на основе сделок образующих раздвижки, попавшие в данный интервал времени (не на основе значений самих раздвижек, посчитанных ранее). Расчёт проводится максимум по 300 000 раздвижек, если в заданном временном интервале раздвижек больше, то будут использованы самые новые по времени 300 000 записей. При подсчёте средней раздвижки средневзвешенные цены сделок по каждого из финансовых инструментов подставляются в формулу, используемую для расчёта [Sell и Buy](params-description.md#p.sell), именно поэтому расчёт средней раздвижки не работает при использовании [Ratio type](params-description.html#s.ratio_type) со значением `Ratio formula` и при использовании флага [Trade formula](params-description.html#p.trade_formula). Так же расчёт средней раздвижки не работает при [Type trade](params-description.html#p.type_trade) равном `IV`.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время получения последней сделки по раздвижке, отображается локальное время в соответствии с часовым поясом, используемым на устройстве пользователя;
- **Robot** - идентификатор робота;
- **Portfolio** - имя портфеля;
- **Price** - значение раздвижки, посчитанное по ценам сделок, в связи с ориентацией робота на максимальную скорость работы, особенностями подключений к некоторым биржам и агрегацией сделок на некоторых площадках вместо цены конкретной сделки может использоваться цена заявки, средняя цена сделок по заявке или худшая из цен сделок, прошедших по заявке; 
- **Buy/Sell** - направление по портфелю (совпадает с направлением заявки по инструменту первой ноги): `Buy` или `Sell`;
- **Quantity** - количество купленных или проданных портфелей;
- **SL** - флаг, показывающий прошли ли сразу все заявки по инструментам второй ноги или эти заявки переставлялись по стоп лоссу или таймеру.

Подсветка жёлтым цветом поля `Price` соответствует взведённому флагу `SL`. Флаг `SL` сделан отдельным столбцом для возможности группировки раздвижек по этому полю, такая группировка позволяет разделить раздвижки на две группы: раздвижки, по которым не было переставлений заявок второй ноги, все заявки второй ноги прошли сразу, и раздвижки, заявки вторых ног которых переставлялись по таймеру или стоп-лоссу. При наведении курсора на поле `Price` отображается всплывающая подсказка, содержащая информацию по сделкам, формирующим данную раздвижку. Поля таблицы во всплывающей подсказке соотвествуют полям таблицы в виджете [Deals for today](interface.md#deals_for_today).

### Finres history <Anchor :ids="['finres_history']" />

Виджет, отображающий раздвижки за конкретный период времени (но не более 100 000 записей). Есть возможность отображения всех раздвижек по роботу или только по конкретному портфелю. Так же для конкретного портфеля можно рассчитать среднюю раздвижку на заданном временном отрезке. Поддерживается экспорт содержимого таблицы в файл. В соотвествии с обновлением системы от 22 июня 2025 года срок хранения исторических данных составляет 6 месяцев.

Раздвижки, попадающие в данный виджет, формируются следующим образом: проходит сделка по первой ноге, после чего происходит попытка выставления заявки по инструментам второй ноги, если заявки выставлены, то раздвижка будет сформирована и добавлена в таблицу только когда все заявки по второй ноге будут сведены в сделку или их переставление закончится ошибкой, если заявки второй ноги не выставлены (была получена ошибка выставления или выставление заявок по второй ноге не требовалась в соответствии с настройками портфеля), то раздвижка будет сформирована и добавлена сразу (при получении ошибки выставления заявки по инструментам второй ноги или после сделки по первой ноге, если выставление заявки по второй ноге не требовалось), при этом так как раздвижки считаются по сделкам, а сделка прошла только по инструменту первой ноги, то раздвижка будет "одноногой". По описанной выше причине количество "одноногих" раздвижек может вырасти при задании ненулевого значения параметра [Overlay](params-description.md#p.overlay). Сделки по выравнивающим заявкам, выставляемым по инструментам второй ноги, раздвижку не формируют и в этот виджет не попадают.

Средняя раздвижка считается непосредственно на основе сделок образующих раздвижки, попавшие в данный интервал времени (не на основе значений самих раздвижек, посчитанных ранее). Расчёт проводится максимум по 300 000 раздвижек, если в заданном временном интервале раздвижек больше, то будут использованы самые новые по времени 300 000 записей. При подсчёте средней раздвижки средневзвешенные цены сделок по каждому из финансовых инструментов подставляются в формулу, используемую для расчёта [Sell и Buy](params-description.md#p.sell), именно поэтому расчёт средней раздвижки не работает при использовании [Ratio type](params-description.html#s.ratio_type) со значением `Ratio formula` и при использовании флага [Trade formula](params-description.html#p.trade_formula). Так же расчёт средней раздвижки не работает при [Type trade](params-description.html#p.type_trade) равном `IV`.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время получения последней сделки по раздвижке, отображается локальное время в соответствии с часовым поясом, используемым на устройстве пользователя;
- **Robot** - идентификатор робота;
- **Portfolio** - имя портфеля;
- **Price** - значение раздвижки, посчитанное по ценам сделок, в связи с ориентацией робота на максимальную скорость работы, особенностями подключений к некоторым биржам и агрегацией сделок на некоторых площадках вместо цены конкретной сделки может использоваться цена заявки, средняя цена сделок по заявке или худшая из цен сделок, прошедших по заявке; 
- **Buy/Sell** - направление по портфелю (совпадает с направлением заявки по инструменту первой ноги): `Buy` или `Sell`;
- **Quantity** - количество купленных или проданных портфелей;
- **SL** - флаг, показывающий прошли ли сразу все заявки по инструментам второй ноги или эти заявки переставлялись по стоп лоссу или таймеру.

Подсветка жёлтым цветом поля `Price` соответствует взведённому флагу `SL`. Флаг `SL` сделан отдельным столбцом для возможности группировки раздвижек по этому полю, такая группировка позволяет разделить раздвижки на две группы: раздвижки, по которым не было переставлений заявок второй ноги, все заявки второй ноги прошли сразу, и раздвижки, заявки вторых ног которых переставлялись по таймеру или стоп-лоссу. При наведении курсора на поле `Price` отображается всплывающая подсказка, содержащая информацию по сделкам, формирующим данную раздвижку. Поля таблицы во всплывающей подсказке соотвествуют полям таблицы в виджете [Deals for today](interface.md#deals_for_today).

### Data connections <Anchor :ids="['data_connections']" />

Виджет, отображающий маркет-дата подключения. Для таких подключений доступны перевод в активное состояние (`Enabled`), в неактивное состояние (`Disabled`) и переподключение. Редко используемые подключения по умолчанию скрыты, для их отображения нужно снять флаг `Hide extra connections` в настройках виджета.

**Неочевидный момент:**  
В роботе не предусмотрен отдельный интерфейс добавления маркет-дата подключений. Но при добавлении некоторых транзакционных подключений есть возможность создания маркет-дата подключений. Такая особенность связана с тем, что некоторые маркет-дата подключения не являются публичными, они требуют авторизации. В нашем случае такие маркет-дата подключения используют авторизационные данные, указанные при создании торгового подключения. Если маркет-дата подключение создано при добавлении транзакционного подключения, то эти два подключения считаются связанными друг с другом, перевод одного из них в состояние `Disabled` приведет в переводу в состояние `Disabled` второго подключения. Маркет-дата подключение, созданное вместе с транзакционным подключением, будет удалено при удалении соответствующего транзакционного подключения.

В основной таблице виджета присутствуют следующие столбцы:

- **Exchange** - название биржи, рынка или брокера (если подключение является подключением-агрегатором данных с разных площадок и предоставляется брокером);
- **Name** - название подключения или его отдельного потока (для подключений, где каждый поток данных представляет из себя отдельную строку в таблице подключений);
- **Status** - состояние подключения и его отдельных потоков. Возможные следующие стаусы подключения и его отдельных потоков:
 * "Онлайн" - выполнен запрос снапшотов и других данных, если они были необходимы, все ответы получены, в настоящий момент подключение/поток получает с сервера обновления и обрабатывает их по мере поступления, имя потока в состоянии "онлайн" отображается на зеленом фоне;
 * "Подключается" - происходит процесс установки соединения, либо ожидаются запрошенные данные (снапшоты, информация по своим заявкам и т.д.), имя потока в состоянии "подключается" отображается на желтом фоне;
 * "Отключено" - сокет не подключен, никакие данные на текущий момент не получаются, имя потока в состоянии "отключено" отображается на красном фоне;
 * "Отключено по времени" - сокет не подключен, никакие данные на текущий момент не получаются, но текущее время не попадает в рабочие дни и часы биржи/брокера, поэтому отключенное состояние подключения следует воспринимать как штатное, имя потока в состоянии "отключено по времен" отображается в зеленой рамке;
 
 подключение находится в состоянии онлайн только когда все элементы в соотвествующей ячейке находятся в состоянии онлайн (т.е. имеют зеленый цвет);
- **Security manager** - виджет для поиска инструментов и формирования списка инструментов в тех подключениях, где полный список инструментов не транслируется.

### Trade connections <Anchor :ids="['trade_connections']" />

Виджет, отображающий торговые (транзакционные) подключения. Доступны добавление нового подключения и следующие действия с существующими подключениями: перевод в активное состояние (`Enabled`), перевод в неактивное состояние (`Disabled`), переподключение и изменение настроек подключения. Посмотреть текущие настройки подключения можно через тот же пункт меню, через который осуществляется изменение настроек.

В основной таблице виджета присутствуют следующие столбцы:

- **Exchange** - название биржи, рынка или брокера (если подключение является подключением-агрегатором данных с разных площадок и предоставляется брокером);
- **Name** - название подключения, заданное пользователем;
- **Trans count** - количество торговых транзакций (выставлений/снятий/переставлений заявок), отправленных через подключение за день, значение обнуляется ежедневно в 5:40 по времени сервера;
- **Status** - состояние подключения и его отдельных потоков. Возможные следующие стаусы подключения и его отдельных потоков:
 * "Онлайн" - выполнен запрос снапшотов и других данных, если они были необходимы, все ответы получены, в настоящий момент подключение/поток получает с сервера обновления и обрабатывает их по мере поступления, имя потока в состоянии "онлайн" отображается на зеленом фоне;
 * "Подключается" - происходит процесс установки соединения, либо ожидаются запрошенные данные (снапшоты, информация по своим заявкам и т.д.), имя потока в состоянии "подключается" отображается на желтом фоне;
 * "Отключено" - сокет не подключен, никакие данные на текущий момент не получаются, имя потока в состоянии "отключено" отображается на красном фоне;
 * "Отключено по времени" - сокет не подключен, никакие данные на текущий момент не получаются, но текущее время не попадает в рабочие дни и часы биржи/брокера, поэтому отключенное состояние подключения следует воспринимать как штатное, имя потока в состоянии "отключено по времен" отображается в зеленой рамке;
 
 подключение находится в состоянии онлайн только когда все элементы в соотвествующей ячейке находятся в состоянии онлайн (т.е. имеют зеленый цвет);
- **Positions** - кнопка, открывающая виджет [Trade connections positions](interface.md#trade_connections_positions), виджет открывается сразу для нужного подключения,в отличие от открытия виджета из главного меню виджетов, для подключений, не поддерживающих такой функционал, кнопка не активна;
- **Orders** - кнопка, открывающая виджет [Trade connections orders](interface.trade_connections_orders), виджет открывается сразу для нужного подключения,в отличие от открытия виджета из главного меню виджетов, для подключений, не поддерживающих такой функционал, кнопка не активна;

### Trade connections orders <Anchor :ids="['trade_connections_orders']" />

Виждет, отображающий активные заявки по инструментам, содержащимся в портфелях пользователя, для конкретного робота и торгового подключения. Отображаемые заявки могут быть выставлены как конкретным роботом, так и иным способом (другим роботом, через терминал и т.д.). Желтым цветом отмечаются строки, соответствующие тем заявкам, которые не отслеживаются роботом. Роботом не отслеживаются заявки, выставленные через терминал, выставленные через другого робота, выставленные через механизм выставления заявок мимо алгоритма виджета [Trade connections positions](interface.md#trade_connections_positions), а так же "потерянные" при перезапуске робота, если робот был перезапущен с активными заявками. Через этот виджет возможно снятие любой отображаемой в виджете заявки.

Виджет доступен не для всех подключений. Неподдерживаемые подключения нельзя выбрать в виджете.

В основной таблице виджета присутствуют следующие столбцы:

- **SecKey** - уникальное имя биржевого инструмента;
- **Order number** - номер заявки, в большинстве случае совпадает с биржевым, в остальных случаях содержит в себе биржевой номер;
- **CLOrdId** - пользовательский идентификатор заявки;
- **Price** - цена, указанная в заявке при её выставлении;
- **Quantity** - количество, указанное в заявке при её выставлении;
- **Amount left** - количество, оставшееся в заявке;
- **Buy/Sell** - направление заявки: `Buy` или `Sell`;
- **Time** - время получения последнего обновления по заявке, отображается локальное время в соответствии с часовым поясом, используемым на устройстве пользователя;
- **Cancel order** - кнопка снятия заявки.

### Trade connections positions <Anchor :ids="['trade_connections_positions']" />

Виджет, отображающий текущие биржевые позиции по валютам и по инструментам (если есть такая возможность, чаще всего позиции по инструментам доступны при торговле деривативами). По умолчанию отображаются все ненулевые позиции по инструментам (даже если этих инструментов нет ни в одном из портфелей) и позиции по инструментам, входящим в хотя бы один из портфелей робота (даже если эти позиции нулевые).

Если для биржи доступно отображение позиций и по валютам, и по инструментам, то в виджете будет отображено две отдельные таблицы.

В таблице позиций по инструментам отображаются биржевая позиция по инструмента и позиция робота по инструменту, вычисленная как сумма позиций данного инструмента по всем портфелям, содержащим данный инструмент. Можно настроить получение уведомлений при несоотвествии этих позиций друг другу.

В таблице позиций/лимитов по инструментам присутствуют следующие столбцы:

- **SecKey** - уникальное имя биржевого инструмента;
- **SecCode** - имя инструмента на бирже;
- **Pos** - биржевая позиция по инструменту;
- **Robot pos** - позиция робота по инструменту, вычисленная как сумма позиций данного инструмента по всем портфелям, содержащим данный инструмент;
- **Mark. price** - цена маркировки, полученная с биржи;
- **Liq. price** - цена ликвидации, полученная с биржи;
- **Pos lag** - настройка допустимой разницы между `Pos` и `Robot pos`, точный смысл параметра определяется ниже идущими флагами;
- **Check equality** - флаг, если взведен, то модуль разности `Pos` и `Robot pos` проверяется на равенство значению `Pos lag`, если равенство не выполняется, то будет выдано уведомление, если флаг не взведен, то уведомление будет выдано только в том случае, если модуль разности `Pos` и `Robot pos` превышает значение `Pos lag`;
- **Tgr notify** - флаг, указывающий на необходимость отправки уведомлений о несоответствии позиций в Telegram, для этого должен быть подключен [Telegram-бот](getting-started.md#telegram-bot);
- **Pos leveling** - кнопка, открывающая окно выравнивания позиций, данная функция позволяет выставить заявку "мимо" алгоритма робота, т.е. такая заявка не будет отслеживаться роботом, не будет относиться к какому-либо портфелю робота и, соответственно, не будет учитываться в позиции робота, по сути выставление такой заявки аналогично выставлению заявки через биржевой терминал;

В таблице позиций/лимитов по валютам присутствуют следующие столбцы:

- **Currency** - название валюты;
- **Pos/Limit** - биржевая позиция или биржевой лимит по валюте.


Пара виджетов [Trade connections orders](interface.md#trade_connections_orders) и [Trade connections positions](interface.md#trade_connections_positions) призвана в какой-то мере заменить терминал. Поэтому из данного виджета из таблицы позиций по инструментам доступно выставление заявок мимо алгоритма робота (аналог выставления заявки из терминала) для выравнивания разницы между биржевой позицией и позицией робота по финансовому инструменту в случае, если эти позиции не совпадают.

Виджет доступен не для всех подключений. Неподдерживаемые подключения нелья выбрать в виджете.

### Deals for today <Anchor :ids="['deals_for_today']" />

Виджет, содержащий последние сделки. Есть возможность отображения всех сделок по роботу, или только по конкретному портфелю, или по конкретнму финансовому инструменту портфеля. В этот виджет попадают все сделки, совершенные роботом, кроме сделок по заявкам, выставленным через виджет [Trade connections positions](interface.md#trade_connections_positions). Позиция по инструментам портфеля считается по тем же данным, которые используются в данной таблице. В соотвествии с обновлением системы от 22 июня 2025 года срок хранения исторических данных составляет 6 месяцев.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время сделки, отображается локальное время в соответствии с часовым поясом, используемым на устройстве пользователя;
- **oNo** - внутренний номер заявки, не всегда совпадающий с биржевым (для MOEX внутренний номер совпадает с биржевым);
- **Portfolio** - имя портфеля;
- **Security** - название финансового инструмента;
- **Target price** - цена первоначально выставленной заявки, значение указывается только для заявок второй ноги, в случае переставления заявки второй ноги по стоп-лоссу или таймеру в данном поле всегда будет указана цена выставления самой первой заявки из этой цепочки, т.е та цена, которая была получена на основе бида или оффера, запомненных на момент выставления заявки по первой ноге;
- **Price** - цена сделки, в связи с ориентацией робота на максимальную скорость работы, особенностями подключений к некоторым биржам и агрегацией сделок на некоторых площадках вместо цены конкретной сделки может использоваться цена заявки, средняя цена сделок по заявке или худшая из цен сделок, прошедших по заявке;
- **Buy/Sell** - направление заявки: `Buy` или `Sell`;
- **Quantity** - количество в сделке, в случае наличия флага `Aggregated` количество в сделке может не совпадать с количеством в конкретной сделке в терминале, так как в таком случае строка, помеченная флагом `Aggregated` может являться агрегацией из нескольких подряд прошедших сделок по одной заявке;
- **Curpos** - позиция по инструменту портфеля после обработки данной сделки;
- **Connection** - торговое подключение, через которое была выставлена заявка, приведшая к данной сделке;
- **Aggregation** - флаг, наличие которого сигнализирует о том, что отображаемая сделка на самом деле может являться агрегацией нескольких сделок.

### Deals history <Anchor :ids="['deals_history']" />

Виджет, отображающий сделки за указанный период времени (но не более 100 000 записей). Есть возможность отображения всех сделок по роботу, или только по конкретному портфелю, или по конкретному финансовому инструменту портфеля. В этот виджет попадают все сделки, совершенные роботом, кроме сделок по заявкам, выставленным через виджет [Trade connections positions](interface.md#trade_connections_positions). Позиция по инструментам портфеля считается по тем же данным, которые используются в данной таблице. Поддерживается экспорт содержимого таблицы в файл. В соотвествии с обновлением системы от 22 июня 2025 года срок хранения исторических данных составляет 6 месяцев.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время сделки, отображается локальное время в соответствии с часовым поясом, используемым на устройстве пользователя;
- **oNo** - внутренний номер заявки, не всегда совпадающий с биржевым (для MOEX внутренний номер совпадает с биржевым);
- **Portfolio** - имя портфеля;
- **Security** - название финансового инструмента;
- **Target price** - цена первоначально выставленной заявки, значение указывается только для заявок второй ноги, в случае переставления заявки второй ноги по стоп-лоссу или таймеру в данном поле всегда будет указана цена выставления самой первой заявки из этой цепочки, т.е та цена, которая была получена на основе бида или оффера, запомненных на момент выставления заявки по первой ноге;
- **Price** - цена сделки, в связи с ориентацией робота на максимальную скорость работы, особенностями подключений к некоторым биржам и агрегацией сделок на некоторых площадках вместо цены конкретной сделки может использоваться цена заявки, средняя цена сделок по заявке или худшая из цен сделок, прошедших по заявке;
- **Buy/Sell** - направление заявки: `Buy` или `Sell`;
- **Quantity** - количество в сделке, в случае наличия флага `Aggregated` количество в сделке может не совпадать с количеством в конкретной сделке в терминале, так как в таком случае строка, помеченная флагом `Aggregated` может являться агрегацией из нескольких подряд прошедших сделок по одной заявке;
- **Curpos** - позиция по инструменту портфеля после обработки данной сделки;
- **Connection** - торговое подключение, через которое была выставлена заявка, приведшая к данной сделке;
- **Aggregation** - флаг, наличие которого сигнализирует о том, что отображаемая сделка на самом деле может являться агрегацией нескольких сделок.

### Portfolios historical chart <Anchor :ids="['portfolios_historical_chart']" />

Данный виждет можно открыть для тех портфелей, по которым включена запись истории параметров. Для открытия виджета необходимо нажать на иконку <img src="@images/icons/chart-2.svg" width="16" height="16"/>  в столбце `Chart` виджета [Portfolios table](interface.md#portfolios_table) на пересечении со строкой, соотвествующей нужному портфелю. График открывается с предустановленными показателями параметров портфеля [Sell](params-description.md#p.sell), [Buy](params-description.md#p.buy), [Lim_sell](params-description.md#p.lim_s), [Lim_buy](params-description.md#p.lim_b). Данные параметры можно удалить или заменить. Запись истории регулируется пользователем через параметр `Save history` в расписании на закладке [Timetable](params-description.md#p.use_tt) в настройках портфеля. График показывается за отображаемый период и исторические данные подгружаются при прокрутке вправо до момента начала сохранения истории. Для рынков МОЕХ следует придерживаться рыночного расписания, чтобы не было не информационных пробелов в истории. Существует лимит на количество портфелей, для которых доступно сохранение истории. По умолчанию лимит составляет 3 портфеля. Для получения консультации по увеличению лимита следует обратиться в техническую поддержку. Лимит обусловлен ресурсами, которые затрачиваются на сохранение и обработку исторических данных по портфелям. Увеличение лимита выше некоторых разумных значений предполагается либо запретить, либо сделать платным.

График можно просматривать в разных таймфреймах, смена таймфрейма слева вверху. Выбранные показатели можно удалить с графика и добавить другие, доступные в выпадающем списке параметры любого портфеля пользователя. Добавление инструментов иконкой плюса слева вверху. Список можно посмотреть в поле `Field`, как показано на рисунке 8.

|![Doc](@images/3.5_1(1).jpg)|
|:--:|
| *Рис. 8* |

На графике всегда присутствует главный инструмент, который нельзя удалить, его можно только поменять через меню добавления инструмента на вкладке `Main`.
Есть возможность добавить несколько портфелей, по которым ведётся запись истории, на один график. Максимальная продолжительность истории графика составляет 3 месяца. Далее она начинает плавно затираться, начиная с самых старых данных.
Следует понимать, что данные для отрисовки графика сохраняются в среднем 3 раза в секунду, так как именно с такой частотой данные отправляет робот, поэтому если за 0.3 секунды были разные значения, то на графике отобразится последнее, никакого усреднения за 0.3 секунды не производится.

### Portfolios realtime chart <Anchor :ids="['portfolios_realtime_chart']" />

Данный виждет можно открыть для тех портфелей, по которым запись истории параметров не ведётся.График открывается с предустановленными показателями параметров портфеля [Sell](params-description.md#p.sell), [Buy](params-description.md#p.buy), [Lim_sell](params-description.md#p.lim_s), [Lim_buy](params-description.md#p.lim_b). Менять и добавлять другие показатели нельзя. Таймфрейм графика недоступен для изменения. Графики начинают отрисовываться с момента открытия виджета. При перезагрузке страницы данные графиков не сохраняются. Это урезанная версия графиков, являющаяся неким компромисом между самой возможностью строить графики и ограниченностью ресуров.

Следует понимать, что данные для отрисовки графика это некий срез online данных по параметрам, по которым торгует робот. Обновления данных отправляются роботом в среднем 3 раза в секунду, поэтому если за 0.3 секунды были разные значния, то на графике отобразится последнее, никакого усреднения за 0.3 секунды не производится.

## Другие элементы интерфейса пользователя

### Панель индикации

|![Alt text](@images/status_panel.png)|
|:--:|
| *Рис. 9* |

В верхней строке интерфейса сайта с правой стороны присутствует панель индикации состояния роботов (рисунок 9). Если никаких проблем не наблюдается (все роботы подключены к серверу управления роботами, все торговые и маркет-дата подключения находятся в состоянии онлайн), то первый значок будет соответствовать тому, что показан на рисунке 9. Следующий знак отражает связь пользовательского интерфейса, открытого в браузере, с сервером управления роботами, если связи нет, то значок будет перечеркнут. Далее идет Московское время, которое берется как время с компьютера пользователя, переведенное в часовой пояс Москвы. Правее располагается индикатор стабильности соединения пользовательского интерфейса, открытого в браузере, с севером управления роботами, индикатор отображает время, которое ушло на отправку последнего сообщения на сервер и получение ответа от него, цветовая индикация светофорного типа позволяет ориентироваться, не вникая в цифры.

### Настройки, скрытые под иконкой пользователя

|![Alt text](@images/user_settings.png)|
|:--:|
| *Рис. 10* |

При нажатии на иконку пользователя в правом верхнем углу страницы сайта открывается меню, представленное на рисунке 10. С помощью пунктов из этого меню пользователь может выполнять следующие действия:

- Авторизовываться под другой ролью в рамках доступных пользователю ролей.
- Менять тему оформления сайта со светлой на темную и обратно.
- Получить ссылку на данное руководство.
- Получить адрес технической поддержки данной платформы.
- Посмтреть список горячих клавиш, применяемых в рамках пользовательского интерфейса на странице браузера. Это список горячих клавиш, специфичных для нашего сайта, общеупотребимые сочетания клавиш так же продолжают работать, вот некоторые из них: `Esc` (закрытие окон и выход из редактора ячеек таблицы без применения значений), `Enter` (вызов редактора на ячейке таблицы, выход из редактора с сохранением значений), `Ctrl+C` (копирование значения), `Ctrl+V` (вставка значения), `F2` (открытие редактора на ячейке таблицы), `Tab` (перемещение между элементами виджета) и т.д.
- Открывать список полученных уведомлений.
- Включать и отключать двухфакторную аутентификацию, просматривать список доверенных устройств, на которых второе подтверждение не запрашивается, и удалять оттуда лишние устройства.
- Производить базовую настройку уведомлений в Telegram, в том числе изначальное подключение телеграм-бота путем указания Telegram ID в данном меню.
- Получать ключ для использования API и пользоваться тестером API.
- Настраивать частоту прихода обновлений в пользовательском интерфейсе (изменять значение по умолчанию имеет смысл только на слабых устройствах при появлении признаков подтормаживания интерфейса).
- Завершить сессию под данным пользователем и разлогиниться.
